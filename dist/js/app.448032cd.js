(function(e){function t(t){for(var a,c,s=t[0],o=t[1],l=t[2],h=0,u=[];h<s.length;h++)c=s[h],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&u.push(r[c][0]),r[c]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);d&&d(t);while(u.length)u.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var o=n[s];0!==r[o]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={app:0},i=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=o;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"004e":function(e,t,n){},"1ee0":function(e,t,n){"use strict";n("b546")},"204c":function(e,t,n){"use strict";n("58c6")},"243d":function(e,t,n){},"464d":function(e,t,n){"use strict";n("995e")},5447:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal"},[t("div",{staticClass:"wrap"},[t("Tree",{ref:"tree",attrs:{selected:"selected"},on:{checkBoxClick:e.checkBoxClick}})],1)])},i=[],c=function(){var e=this,t=e._self._c;return e.data?t("div",{staticClass:"tree"},[e.data.length?t("LTreeNodeList",{ref:"TreeNodeList",attrs:{data:e.data}}):t("div",[e._v("无数据")])],1):t("div",[e._v("载入中")])},s=[],o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"node"},[t("div",{staticClass:"node-content"},[t("Caret",{attrs:{isLeaf:e.data.children&&e.data.children.length,expand:e.expand},on:{click:e.caretClick}}),t("CheckBox",{attrs:{flag:e.flag},on:{click:e.checkBoxClick}}),t("span",{on:{click:e.labelClick}},[e._v(" "+e._s(e.data.name)+" ")]),t("span",[e._v("( "+e._s(e.checked)+" / "+e._s(e.total)+" )")])],1),t("div",{staticClass:"p20"},[e.expand&&e.data.children?t("LTreeNodeList",{ref:"TreeNodeList",attrs:{data:e.data.children}}):e._e()],1)])},l=[],d=function(){var e=this,t=e._self._c;return t("span",{class:{checkbox:!0,highlight:this.flag>0},on:{click:e.click}},[e._v(" "+e._s(e.mark)+" ")])},h=[];const u={1:"‒",2:"✔",0:" "};var f={name:"CheckBox",props:["flag"],computed:{mark(){return u[this.flag]}},methods:{click(){let e;e=2===this.flag?0:2,this.$emit("click",e)}}},p=f,k=(n("464d"),n("2877")),v=Object(k["a"])(p,d,h,!1,null,"6f64d207",null),$=v.exports,m=function(){var e=this,t=e._self._c;return e.isLeaf?t("span",{class:{"expand-icon":!0,"caret-down":e.expand},on:{click:e.click}},[e._v("▶")]):t("span",{staticClass:"expand-icon"})},g=[],b={name:"Caret",props:["isLeaf","expand"],methods:{click(){this.$emit("click",!this.expand)}}},x=b,_=(n("aa6a"),Object(k["a"])(x,m,g,!1,null,"3b85c406",null)),y=_.exports;n("14d9");const C=(e,t,n,a)=>{e.forEach(e=>{if(e.$parent=t,e.children){e.$children||(e.$children=e.children.slice()),C(e.$children,e,n,a);let t=0,r=1;const i=[];for(let n=0;n<e.$children.length;n++){const a=e.$children[n];i.push(a),t+=a.$checked,r+=a.$total}e.$checked=t,e.$total=r}else!a||e.name.includes(a)?e.$keep=!0:e.$keep=!1,e.$checked=n[e.id]?1:0,e.$total=1})},T=(e,t)=>{e.$checked=t?e.$total:0,e.children&&e.children.forEach(e=>{T(e,t)})},N=e=>{if(e){let t=0;for(let n=0;n<e.children.length;n++)t+=e.children[n].$checked;e.$checked=t,N(e.$parent)}},w=(e,t,n)=>(e&&e.forEach(e=>{e.$checked>0&&(n?!e.children&&t.push(e):t.push(e),w(e.children,t,n))}),t),O=2,j=0,L=1;var P={name:"TreeNode",props:["data"],data(){return{expand:!1,checked:0,total:0}},components:{CheckBox:$,Caret:y},computed:{flag(){return this.checked===this.total?O:0===this.checked?j:L}},created(){this.$tree=this.$parent.$tree,this.update()},methods:{update(){this.checked=this.data.$checked,this.total=this.data.$total},setSonNode(){var e;this.update(),null===(e=this.$refs.TreeNodeList)||void 0===e||e.setSonNode()},setParentNode(){this.update(),this.$parent.setParentNode()},checkBoxClick(e){T(this.data,e),N(this.data.$parent),this.$tree.$emit("checkBoxClick",this.data),this.setSonNode(),this.$parent.setParentNode()},labelClick(){this.$tree.$emit("labelClick",this.data)},caretClick(e){this.expand=e}}},S=P,B=(n("1ee0"),Object(k["a"])(S,o,l,!1,null,"52e6f38a",null)),D=B.exports,E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"node-list"},[e._l(e.data,(function(n,a){return t("div",{key:a},[a<(e.page+1)*e.size?t("LTreeNode",{key:a,ref:"TreeNode",refInFor:!0,attrs:{data:n}}):e._e()],1)})),e.data.length>(e.page+1)*e.size?t("div",{staticClass:"more",on:{click:function(t){e.page++}}},[e._v(" 点击显示更多数据... ")]):e._e()],2)},M=[],z={name:"TreeNodeList",props:["data"],data(){return{page:0}},created(){this.$tree=this.$parent.$tree,this.size=20},methods:{setSonNode(){this.$nextTick((function(){var e;null===(e=this.$refs.TreeNode)||void 0===e||e.forEach(e=>{e.setSonNode()})}))},setParentNode(){var e,t;null===(e=(t=this.$parent).setParentNode)||void 0===e||e.call(t)}}},J=z,K=(n("204c"),Object(k["a"])(J,E,M,!1,null,"299b1ff8",null)),A=K.exports;a["a"].component("LTreeNode",D),a["a"].component("LTreeNodeList",A);var F={name:"TreeRoot",created(){this.data=null,this.keyword="",this.selected=[],this.$tree=this},methods:{setData(e,t=[],n=""){this.data=e,this.selected=t,this.keyword=n,this.initTreeData()},getData(){return this.data},setSelected(e){this.selected=e,this.initTreeData()},getSelected(e){return w(this.data,[],e)},setKeyword(e){this.keyword=e,this.initTreeData()},getKeyword(){return this.keyword},initTreeData(){const e=Object.create(null);this.selected.forEach(t=>e[t]=!0),C(this.data,null,e,this.keyword),this.$forceUpdate()}}},I=F,R=(n("5fad"),Object(k["a"])(I,c,s,!1,null,null,null)),U=R.exports;const q=(e,t=10)=>e>0?Array(t).fill().map((n,a)=>({name:`name-${e}-${a}`,id:`id-${e}-${a}`,children:q(e-1,t)})):[],G=()=>Promise.resolve(q(6,10));var H={name:"Demo",data(){return{selected:[]}},components:{Tree:U},mounted(){G().then(e=>{this.$refs.tree.setData(e)})},methods:{checkBoxClick(e){console.log(e),console.log(this.$refs.tree.getSelected())}}},Q=H,V=(n("f9d9"),Object(k["a"])(Q,r,i,!1,null,null,null)),W=V.exports;a["a"].config.productionTip=!1,a["a"].config.devtools=!1,new a["a"]({render:e=>e(W)}).$mount("#app")},"58c6":function(e,t,n){},"5fad":function(e,t,n){"use strict";n("5447")},"995e":function(e,t,n){},aa6a:function(e,t,n){"use strict";n("243d")},b546:function(e,t,n){},f9d9:function(e,t,n){"use strict";n("004e")}});
//# sourceMappingURL=app.448032cd.js.map