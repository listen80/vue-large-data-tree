(function(e){function t(t){for(var n,c,s=t[0],o=t[1],l=t[2],h=0,u=[];h<s.length;h++)c=s[h],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&u.push(r[c][0]),r[c]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);d&&d(t);while(u.length)u.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var o=a[s];0!==r[o]&&(n=!1)}n&&(i.splice(t--,1),e=c(c.s=a[0]))}return e}var n={},r={app:0},i=[];function c(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=e,c.c=n,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(a,n,function(t){return e[t]}.bind(null,n));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=o;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0403":function(e,t,a){"use strict";a("95bf")},"204c":function(e,t,a){"use strict";a("58c6")},"243d":function(e,t,a){},"347f":function(e,t,a){"use strict";a("f13b")},"4a82":function(e,t,a){"use strict";a("7f4b")},"56d7":function(e,t,a){"use strict";a.r(t);var n=a("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal"},[t("div",{staticClass:"wrap"},[t("div",{staticClass:"tree"},[t("Tree",{ref:"tree",on:{checkBoxClick:e.checkBoxClick}})],1),t("div")])])},i=[],c=function(){var e=this,t=e._self._c;return e.data?t("div",[e.data.length?t("LTreeNodeList",{ref:"TreeNodeList",attrs:{data:e.data}}):t("div",[e._v("无数据")])],1):t("div",[e._v("载入中")])},s=[],o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"node"},[t("div",{staticClass:"node-content"},[t("Caret",{attrs:{isLeaf:e.data.children&&e.data.children.length,expand:e.expand},on:{click:e.caretClick}}),t("CheckBox",{attrs:{flag:e.flag},on:{click:e.checkBoxClick}}),t("span",{on:{click:e.labelClick}},[e._v(e._s(e.data.name))]),t("span",[e._v("( "+e._s(e.checked)+" / "+e._s(e.total)+" )")])],1),t("div",{staticClass:"p20"},[e.expand&&e.data.children?t("LTreeNodeList",{ref:"TreeNodeList",attrs:{data:e.data.children}}):e._e()],1)])},l=[],d=function(){var e=this,t=e._self._c;return t("span",{class:{checkbox:!0,highlight:this.flag>0},on:{click:e.click}},[e._v(" "+e._s(e.mark)+" ")])},h=[];const u={1:"‒",2:"✔",0:" "};var f={name:"CheckBox",props:["flag"],computed:{mark(){return u[this.flag]}},methods:{click(){let e;e=2===this.flag?0:2,this.$emit("click",e)}}},p=f,k=(a("347f"),a("2877")),v=Object(k["a"])(p,d,h,!1,null,"7db69689",null),$=v.exports,m=function(){var e=this,t=e._self._c;return e.isLeaf?t("span",{class:{"expand-icon":!0,"caret-down":e.expand},on:{click:e.click}},[e._v("▶")]):t("span",{staticClass:"expand-icon"})},b=[],g={name:"Caret",props:["isLeaf","expand"],methods:{click(){this.$emit("click",!this.expand)}}},x=g,_=(a("aa6a"),Object(k["a"])(x,m,b,!1,null,"3b85c406",null)),y=_.exports;a("14d9");const C=(e,t,a,n)=>{e.forEach(e=>{if(e.$parent=t,e.children){e.$children||(e.$children=e.children.slice()),C(e.$children,e,a,n);let t=0,r=1;const i=[];for(let a=0;a<e.$children.length;a++){const n=e.$children[a];i.push(n),t+=n.$checked,r+=n.$total}e.$checked=t,e.$total=r}else!n||e.name.includes(n)?e.$keep=!0:e.$keep=!1,e.$checked=a[e.id]?1:0,e.$total=1})},T=(e,t)=>{e.$checked=t?e.$total:0,e.children&&e.children.forEach(e=>{T(e,t)})},N=e=>{if(e){let t=0;for(let a=0;a<e.children.length;a++)t+=e.children[a].$checked;e.$checked=t,N(e.$parent)}},w=(e,t,a)=>(e&&e.forEach(e=>{e.$checked>0&&(a?!e.children&&t.push(e):t.push(e),w(e.children,t,a))}),t),O=2,j=0,L=1;var P={name:"TreeNode",props:["data"],data(){return{expand:!1,checked:0,total:0}},components:{CheckBox:$,Caret:y},computed:{flag(){return this.checked===this.total?O:0===this.checked?j:L}},created(){this.$tree=this.$parent.$tree,this.update()},methods:{update(){this.checked=this.data.$checked,this.total=this.data.$total},setSonNode(){var e;this.update(),null===(e=this.$refs.TreeNodeList)||void 0===e||e.setSonNode()},setParentNode(){this.update(),this.$parent.setParentNode()},checkBoxClick(e){T(this.data,e),N(this.data.$parent),this.$tree.$emit("checkBoxClick",this.data),this.setSonNode(),this.$parent.setParentNode()},labelClick(){this.$tree.$emit("labelClick",this.data)},caretClick(e){this.expand=e}}},S=P,D=(a("4a82"),Object(k["a"])(S,o,l,!1,null,"4cec00bd",null)),B=D.exports,E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"node-list"},[e._l(e.data,(function(a,n){return t("div",{key:n},[n<(e.page+1)*e.size?t("LTreeNode",{key:n,ref:"TreeNode",refInFor:!0,attrs:{data:a}}):e._e()],1)})),e.data.length>(e.page+1)*e.size?t("div",{staticClass:"more",on:{click:function(t){e.page++}}},[e._v(" 点击显示更多数据... ")]):e._e()],2)},M=[],z={name:"TreeNodeList",props:["data"],data(){return{page:0}},created(){this.$tree=this.$parent.$tree,this.size=20},methods:{setSonNode(){this.$nextTick((function(){var e;null===(e=this.$refs.TreeNode)||void 0===e||e.forEach(e=>{e.setSonNode()})}))},setParentNode(){var e,t;null===(e=(t=this.$parent).setParentNode)||void 0===e||e.call(t)}}},J=z,K=(a("204c"),Object(k["a"])(J,E,M,!1,null,"299b1ff8",null)),A=K.exports;n["a"].component("LTreeNode",B),n["a"].component("LTreeNodeList",A);var F={name:"TreeRoot",created(){this.data=null,this.keyword="",this.selected=[],this.$tree=this},methods:{setData(e,t=[],a=""){this.data=e,this.selected=t,this.keyword=a,this.initTreeData()},getData(){return this.data},setSelected(e){this.selected=e,this.initTreeData()},getSelected(e){return w(this.data,[],e)},setKeyword(e){this.keyword=e,this.initTreeData()},getKeyword(){return this.keyword},initTreeData(){const e=Object.create(null);this.selected.forEach(t=>e[t]=!0),C(this.data,null,e,this.keyword),this.$forceUpdate()}}},I=F,R=Object(k["a"])(I,c,s,!1,null,null,null),U=R.exports;const q=(e,t=10)=>e>0?Array(t).fill().map((a,n)=>({name:`name-${e}-${n}`,id:`id-${e}-${n}`,children:q(e-1,t)})):[],G=()=>Promise.resolve(q(6,10));var H={name:"Demo",data(){return{selected:[]}},components:{Tree:U},mounted(){this.initTreeData()},methods:{initTreeData(){G().then(e=>{this.$refs.tree.setData(e)})},checkBoxClick(e){console.log(e),console.log(this.$refs.tree.getSelected())}}},Q=H,V=(a("0403"),Object(k["a"])(Q,r,i,!1,null,null,null)),W=V.exports;n["a"].config.productionTip=!1,n["a"].config.devtools=!1,new n["a"]({render:e=>e(W)}).$mount("#app")},"58c6":function(e,t,a){},"7f4b":function(e,t,a){},"95bf":function(e,t,a){},aa6a:function(e,t,a){"use strict";a("243d")},f13b:function(e,t,a){}});
//# sourceMappingURL=app.ae5edd33.js.map